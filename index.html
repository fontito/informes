<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Dictado de Informes MSK - PUNCIONES</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f2f2f2;
    }
    textarea {
      font-family: 'Segoe UI', 'Verdana', 'Calibri', sans-serif;
      width: 100%;
      height: 600px;
      font-size: 18px;
      padding: 10px;
    }
    select, button {
      font-size: 18px;
      margin-top: 10px;
      padding: 5px;
    }
    .controls {
      margin-bottom: 15px;
    }
  </style>
</head>
<body>
  <h1>Dictado de Informes MSK - PUNCIONES</h1>

  <div class="controls">
    <label for="plantilla">Elegir plantilla:</label>
    <select id="plantilla">
      <option value="">-- Seleccionar --</option>
      <option value="Estudio: R.M.I. DE RODILLA DERECHA SIN CONTRASTE:
Se realiza R.M.I. de rodilla derecha, con cortes axiales, coronales y sagitales ponderando los tiempos de relajaci贸n T1, T2 y secuencias con saturaci贸n de grasa.

Los meniscos muestran una normal morfolog铆a y se帽al, sin identificarse signos de ruptura.

Los ligamentos cruzados y colaterales se observan 铆ntegros con una normal orientaci贸n.

El tend贸n rotuliano y cuadricipital son normales.

Se observa una normal morfolog铆a y se帽al de los c贸ndilos femorales y meseta tibial sin hallazgos de edema 贸seo ni lesiones osteocondrales en las superficies articulares.

Adecuada congruencia femoropatelar. No se evidencian alteraciones en las superficies articulares.

La grasa de Hoffa sin alteraciones.

L铆quido articular en cantidad habitual.

Saluda atte.
">Rodilla derecha</option>
      <option value="RMN columna lumbar. Discopat铆a degenerativa L4-L5 con protrusi贸n discal posterior central. No se observa compromiso radicular claro.">Columna - Discopat铆a</option>
      <option value="TC de t贸rax sin contraste. Patr贸n en vidrio esmerilado bilateral compatible con proceso inflamatorio/infeccioso. Correlacionar cl铆nicamente.">T贸rax - Vidrio esmerilado</option>
    </select>
    <button onclick="cargarPlantilla()">Cargar plantilla</button>
    <button onclick="copiarTexto()">Copiar reporte</button>
  </div>

  <textarea id="texto" placeholder="Ac谩 va tu reporte..."></textarea>

  <div class="controls">
    <button onclick="iniciarDictado()"> Iniciar dictado</button>
    <button onclick="detenerDictado()"> Detener dictado</button>
  </div>

  <script>
    const textarea = document.getElementById("texto");

    const plantillas = {
      "rodilla derecha": `Estudio: R.M.I. DE RODILLA DERECHA SIN CONTRASTE:
Se realiza R.M.I. de rodilla derecha, con cortes axiales, coronales y sagitales ponderando los tiempos de relajaci贸n T1, T2 y secuencias con saturaci贸n de grasa.

Los meniscos muestran una normal morfolog铆a y se帽al, sin identificarse signos de ruptura.

Los ligamentos cruzados y colaterales se observan 铆ntegros con una normal orientaci贸n.

El tend贸n rotuliano y cuadricipital son normales.

Se observa una normal morfolog铆a y se帽al de los c贸ndilos femorales y meseta tibial sin hallazgos de edema 贸seo ni lesiones osteocondrales en las superficies articulares.

Adecuada congruencia femoropatelar. No se evidencian alteraciones en las superficies articulares.

La grasa de Hoffa sin alteraciones.

L铆quido articular en cantidad habitual.

Saluda atte.`,
      "columna": "RMN columna lumbar. Discopat铆a degenerativa L4-L5 con protrusi贸n discal posterior central. No se observa compromiso radicular claro.",
      "t贸rax": "TC de t贸rax sin contraste. Patr贸n en vidrio esmerilado bilateral compatible con proceso inflamatorio/infeccioso. Correlacionar cl铆nicamente."
    };

    function cargarPlantilla() {
      const plantilla = document.getElementById("plantilla").value;
      if (plantilla) textarea.value = plantilla;
    }

    function copiarTexto() {
      textarea.select();
      document.execCommand("copy");
      alert("Reporte copiado al portapapeles.");
    }

    let recognition;
    function iniciarDictado() {
      if (!('webkitSpeechRecognition' in window)) {
        alert('Tu navegador no soporta reconocimiento de voz. Prob谩 con Chrome.');
        return;
      }
      recognition = new webkitSpeechRecognition();
      recognition.lang = 'es-AR';
      recognition.interimResults = true;
      recognition.continuous = true;

      recognition.onresult = (event) => {
  let textoFinal = "";
  for (let i = event.resultIndex; i < event.results.length; ++i) {
    if (event.results[i].isFinal) {
      let transcripto = event.results[i][0].transcript.trim().toLowerCase();

      transcripto = transcripto
        .replace("rodilla derecha", "
" + plantillas["rodilla derecha"] + "
")
        .replace("columna", "
" + plantillas["columna"] + "
")
        .replace(/t[贸o]rax/, "
" + plantillas["t贸rax"] + "
")
        .replace(/coma/g, ",")
        .replace(/punto nuevo p谩rrafo|punto nuevo parrafo/g, ".

")
        .replace(/nuevo p谩rrafo|nuevo parrafo/g, "

")
        .replace(/punto/g, ".")
        .replace(/dos puntos/g, ":");

      textoFinal += transcripto + " ";
    }
  }
  textarea.value += textoFinal;
};

      recognition.start();
    }

    function detenerDictado() {
      if (recognition) recognition.stop();
    }
  </script>
</body>
</html>
